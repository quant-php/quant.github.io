"use strict";(self.webpackChunkthorsten_suckow_homberg_de=self.webpackChunkthorsten_suckow_homberg_de||[]).push([[250],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>g});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=r.createContext({}),p=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=p(e.components);return r.createElement(l.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),c=p(n),m=a,g=c["".concat(l,".").concat(m)]||c[m]||d[m]||o;return n?r.createElement(g,i(i({ref:t},u),{},{components:n})):r.createElement(g,i({ref:t},u))}));function g(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[c]="string"==typeof e?e:a,i[1]=s;for(var p=2;p<o;p++)i[p]=n[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},4270:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>p});var r=n(7462),a=(n(7294),n(3905));const o={id:"quant_core",title:"Core",slug:"/api/packages/quant/core"},i="quant/core",s={unversionedId:"packages/quant/quant_core",id:"packages/quant/quant_core",title:"Core",description:"Namespace: Quant/Core",source:"@site/docs/packages/quant/core.md",sourceDirName:"packages/quant",slug:"/api/packages/quant/core",permalink:"/docs/api/packages/quant/core",draft:!1,editUrl:"https://github.com/quant-php/quant.github.io/tree/main/docs/packages/quant/core.md",tags:[],version:"current",lastUpdatedBy:"Thorsten Suckow-Homberg",lastUpdatedAt:1683827882,formattedLastUpdatedAt:"May 11, 2023",frontMatter:{id:"quant_core",title:"Core",slug:"/api/packages/quant/core"},sidebar:"docs",previous:{title:"Packages",permalink:"/docs/api/packages"}},l={},p=[{value:"Installation",id:"installation",level:2},{value:"<code>#[Getter]</code> and <code>#[Setter]</code>",id:"getter-and-setter",level:2},{value:"Getters",id:"getters",level:3},{value:"Setters and Guards",id:"setters-and-guards",level:3},{value:"Using the guards with <code>__construct</code>",id:"using-the-guards-with-__construct",level:4},{value:"Constructor Property Promotion",id:"constructor-property-promotion",level:3},{value:"Attributes on class-level",id:"attributes-on-class-level",level:3},{value:"Attribute Configuration",id:"attribute-configuration",level:3},{value:"Access-level modifiers",id:"access-level-modifiers",level:4},{value:"Available modifier",id:"available-modifier",level:5},{value:"Remarks",id:"remarks",level:3}],u={toc:p},c="wrapper";function d(e){let{components:t,...n}=e;return(0,a.kt)(c,(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"quantcore"},(0,a.kt)("inlineCode",{parentName:"h1"},"quant/core")),(0,a.kt)("p",null,"Namespace: ",(0,a.kt)("inlineCode",{parentName:"p"},"Quant/Core")),(0,a.kt)("h2",{id:"installation"},"Installation"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"quant/core")," comes bundled with ",(0,a.kt)("strong",{parentName:"p"},"quant"),". To install it separately, follow the ",(0,a.kt)("a",{parentName:"p",href:"/docs/installation#packages"},"installation instructions"),"."),(0,a.kt)("h2",{id:"getter-and-setter"},(0,a.kt)("inlineCode",{parentName:"h2"},"#[Getter]")," and ",(0,a.kt)("inlineCode",{parentName:"h2"},"#[Setter]")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-php",metastring:"title=Example",title:"Example"},'use Quant\\Core\\Trait\\AccessorGenerator;\nuse Quant\\Core\\Attribute\\Setter;\nuse Quant\\Core\\Attribute\\Getter;\n\nclass Target \n{\n    use AccessorGenerator;\n  \n    #[Setter] #[Getter] private string $value = "";\n}\n\n$target = new Target();\n$target->setValue("new value")->getValue(); // "new value"\n')),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"Quant/Core/Trait/AccessorGenerator")," provides accessors to object properties attributed with ",(0,a.kt)("inlineCode",{parentName:"p"},"#[Setter]"),"\nand/or ",(0,a.kt)("inlineCode",{parentName:"p"},"#[Getter]"),": When such attributes are used, ",(0,a.kt)("inlineCode",{parentName:"p"},"get"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"set")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"is")," methods will be available with an object instance\nwhose class uses these annotations ",(0,a.kt)("em",{parentName:"p"},"(sic!)"),"."),(0,a.kt)("p",null,"Such attributes may be configured for a class or its properties and/or its constructor parameters when using ",(0,a.kt)("strong",{parentName:"p"},"constructor property promotion"),"."),(0,a.kt)("h3",{id:"getters"},"Getters"),(0,a.kt)("p",null,"Getters are available for properties using the ",(0,a.kt)("inlineCode",{parentName:"p"},"#[Getter]")," attribute. Except for ",(0,a.kt)("inlineCode",{parentName:"p"},"boolean"),"-values, a ",(0,a.kt)("inlineCode",{parentName:"p"},"getter")," is always prefixed with\n",(0,a.kt)("inlineCode",{parentName:"p"},"get"),". ",(0,a.kt)("inlineCode",{parentName:"p"},"boolean")," values can be queried using the prefix ",(0,a.kt)("inlineCode",{parentName:"p"},"is"),":"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-php",metastring:"title=Getters",title:"Getters"},'use Quant\\Core\\Trait\\AccessorGenerator;\nuse Quant\\Core\\Attribute\\Getter;\nclass Target \n{\n    use AccessorGenerator;\n  \n    #[Getter] private string $value = "default";\n    #[Getter] private bool $valid = true;\n}\n\n$target = new Target();\n$target->getValue(); // "default"\n$target->isValid(); // true\n')),(0,a.kt)("h3",{id:"setters-and-guards"},"Setters and Guards"),(0,a.kt)("p",null,"The return value of a ",(0,a.kt)("inlineCode",{parentName:"p"},"set"),"-method provided with ",(0,a.kt)("inlineCode",{parentName:"p"},"AccessorGenerator")," will always be the owning instance. "),(0,a.kt)("p",null,"To use invariants with ",(0,a.kt)("inlineCode",{parentName:"p"},"setters"),", each ",(0,a.kt)("inlineCode",{parentName:"p"},"setter")," has an ",(0,a.kt)("inlineCode",{parentName:"p"},"apply"),"-method that guards the property. If implemented, its return value\nwill be used as the new value for the property. This allows for applying validation and coercion logic without accidentally\nbreaking the ",(0,a.kt)("inlineCode",{parentName:"p"},"AccessorGenerator"),"'s interface."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-php",metastring:'title="Setters and Guards"',title:'"Setters',and:!0,'Guards"':!0},'use Quant\\Core\\Trait\\AccessorGenerator;\nuse Quant\\Core\\Attribute\\Setter;\n\nclass Target \n{\n    use AccessorGenerator;\n  \n    #[Setter] private string $value = "";\n\n    protected function applyValue(string $value): string\n    {\n        return $value === "" ? $this->value : $value;\n    }\n}\n\n$target = new Target();\n$target->setValue("new value")->setValue("")->getValue(); // "new value"\n')),(0,a.kt)("h4",{id:"using-the-guards-with-__construct"},"Using the guards with ",(0,a.kt)("inlineCode",{parentName:"h4"},"__construct")),(0,a.kt)("p",null,"If an object requires the guards to be used with ",(0,a.kt)("a",{parentName:"p",href:"#constructor-property-promotion"},"constructor arguments"),", the method ",(0,a.kt)("inlineCode",{parentName:"p"},"AccessorGenerator::applyProperties()"),"\ncan be used: "),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-php",metastring:'title="Calling guards with the constructor"',title:'"Calling',guards:!0,with:!0,the:!0,'constructor"':!0},'use Quant\\Core\\Trait\\AccessorGenerator;\nuse Quant\\Core\\Attribute\\Setter;\n\nclass Target \n{\n    use AccessorGenerator;\n    \n    public function __construct(\n        private string $a,\n        #[Setter]\n        private string $b\n    ) {\n        $this->applyProperties([1 => $b]);\n    }\n\n    protected function applyB(string $value): mixed \n    {\n        echo "Called by the constructor.";\n        return $value;\n    }\n}\n')),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"AccessorGenerator::applyProperties(array $args)")," configures the properties of ",(0,a.kt)("strong",{parentName:"p"},"this")," class with the values available in ",(0,a.kt)("inlineCode",{parentName:"p"},"$args"),".\nThe ordinal value of the individual entries in ",(0,a.kt)("inlineCode",{parentName:"p"},"$args")," is expected to match the ordinal value of the parameter\nthat is to be configured with the value, so it treats the arguments positionally: To use an argument\nfor ",(0,a.kt)("inlineCode",{parentName:"p"},"$b")," with the following constructor"),(0,a.kt)("p",null," ",(0,a.kt)("inlineCode",{parentName:"p"},"__construct($a = null, $b = null)")),(0,a.kt)("p",null," an array in the form of"),(0,a.kt)("p",null," ",(0,a.kt)("inlineCode",{parentName:"p"},'$args = [1 => "value_of_b"]')),(0,a.kt)("p",null," must be passed to ",(0,a.kt)("inlineCode",{parentName:"p"},"applyProperties")," "),(0,a.kt)("admonition",{type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"Argument inspection can be leveraged to the ",(0,a.kt)("inlineCode",{parentName:"p"},"AccessorGenerator")," by applying ",(0,a.kt)("inlineCode",{parentName:"p"},"applyProperties()")," to the return value\nof ",(0,a.kt)("inlineCode",{parentName:"p"},"func_get_args()"),":"),(0,a.kt)("pre",{parentName:"admonition"},(0,a.kt)("code",{parentName:"pre",className:"language-php"},"$this->applyProperties(func_get_args());\n"))),(0,a.kt)("h3",{id:"constructor-property-promotion"},"Constructor Property Promotion"),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"AccessorGenerator")," considers constructor parameters used with ",(0,a.kt)("strong",{parentName:"p"},"Constructor Property Promotion"),". Configuring the attributes\ndirectly on constructor parameters greatly reduces boilerplate code:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-php",metastring:'title="Constructor Property Promotion"',title:'"Constructor',Property:!0,'Promotion"':!0},"use Quant\\Core\\Trait\\AccessorGenerator;\nuse Quant\\Core\\Attribute\\Setter;\n\nclass Target \n{\n    use AccessorGenerator;\n\n    public function __construct(\n         #[Setter] #[Getter]\n         public string $value,\n         #[Setter]\n         private bool $state\n     ) {\n    {\n    }\n}\n")),(0,a.kt)("h3",{id:"attributes-on-class-level"},"Attributes on class-level"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"#[Setter]")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"#[Getter]")," can also be used on class-level:  "),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-php",metastring:'title="class-level setters and getters"',title:'"class-level',setters:!0,and:!0,'getters"':!0},"use Quant\\Core\\Trait\\AccessorGenerator;\nuse Quant\\Core\\Attribute\\Setter;\nuse Quant\\Core\\Attribute\\Getter;\n\n#[Setter] #[Getter]\nclass Target \n{\n    use AccessorGenerator;\n\n    public function __construct(\n         public string $value,\n         private bool $state\n     ) {\n    {\n    }\n}\n")),(0,a.kt)("admonition",{type:"info"},(0,a.kt)("p",{parentName:"admonition"},"Using ",(0,a.kt)("inlineCode",{parentName:"p"},"#[Getter]")," / ",(0,a.kt)("inlineCode",{parentName:"p"},"#[Setter]")," on class-level overrides any property-specific configuration.")),(0,a.kt)("h3",{id:"attribute-configuration"},"Attribute Configuration"),(0,a.kt)("h4",{id:"access-level-modifiers"},"Access-level modifiers"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"#[Getter]")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"#[Setter]")," can be configured with access-level modifiers. To do so, import the ",(0,a.kt)("inlineCode",{parentName:"p"},"Modifier"),"-enum from\nthe package ",(0,a.kt)("inlineCode",{parentName:"p"},"Quant\\Core\\Lang\\Modifer"),", and pass the required modifier as an argument to the accessor-attribute:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-php"},"use Quant\\Core\\Attribute\\Setter;\nuse Quant\\Core\\Lang\\Modifier;\n\n#[Getter(Modifier::PROTECTED)\nclass A \n{\n    // ...\n")),(0,a.kt)("p",null,"The visibility of the methods provided by the ",(0,a.kt)("inlineCode",{parentName:"p"},"AccessorGenerator")," correspond to the particular modifier. The default\nmodifier, if none is provided, is ",(0,a.kt)("inlineCode",{parentName:"p"},"Quant\\Core\\Lang\\Modifier\\Modifier::PUBLIC"),"."),(0,a.kt)("h5",{id:"available-modifier"},"Available modifier"),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"quant"),"-modifier semantically correspond to language level modifier."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"Quant\\Core\\Lang\\Modifier::PRIVATE")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"Quant\\Core\\Lang\\Modifier::PROTECTED")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"Quant\\Core\\Lang\\Modifier::PUBLIC"))),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-php",metastring:'title="access-level modifiers"',title:'"access-level','modifiers"':!0},'use Quant\\Core\\Trait\\AccessorGenerator;\nuse Quant\\Core\\Attribute\\Setter;\nuse Quant\\Core\\Attribute\\Getter;\nuse Quant\\Core\\Lang\\Modifier;\n\nclass A \n{\n     use AccessorGenerator;\n\n     public function __construct(\n          public string $value,\n          #[Getter(Modifier::PROTECTED)]\n          private bool $state,\n          #[Getter(Modifier::PRIVATE)]\n          private pool $isValid\n      ) {\n     {\n     }\n     \n     public function proxyIsValid(): bool\n     {\n         return $this->isValid();\n     }\n }\n \n\nclass B extends A \n{\n    public function proxyIsState(): bool\n    {\n        return $this->isState();\n    }\n} \n\n$a = new A("value", true, false);\n$a->isValid(); // BadMethodCallException\n$a->proxyIsValid(); // false\n\n$a = new B("value", true, false);\n$b->isState(); // BadMethodCallException\n$b->proxyIsState();// true \n')),(0,a.kt)("h3",{id:"remarks"},"Remarks"),(0,a.kt)("p",null,"If the target already contains ",(0,a.kt)("inlineCode",{parentName:"p"},"setters")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"getters")," matching the naming conventions used by the ",(0,a.kt)("inlineCode",{parentName:"p"},"AccessorGenerator"),",\nhandling of these methods will default to the owning object, and not the ",(0,a.kt)("inlineCode",{parentName:"p"},"AccessorGenerator"),". This also applies to\nthe ",(0,a.kt)("a",{parentName:"p",href:"#setters-and-guards"},(0,a.kt)("inlineCode",{parentName:"a"},"applyProperties")),"-method."))}d.isMDXComponent=!0}}]);